<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.6 at 2015-03-07 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>spBee &#x2013; spBee - Stored Procedure Bee</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20150307" />
    <meta http-equiv="Content-Language" content="en" />
                                                    
<script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=java&amp;lang=xml&amp;lang=sql" type="text/javascript"></script>
                      
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                spBee
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2015-03-07</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0</span>
                      </div>
            <div class="xright">        
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
            <strong>Introduction</strong>
          </li>
                  <li class="none">
                          <a href="troubleshooting.html" title="Troubleshooting">Troubleshooting</a>
            </li>
                  <li class="none">
                          <a href="why-stored-procedures.html" title="Why Stored Procedures">Why Stored Procedures</a>
            </li>
                  <li class="none">
                          <a href="todo.html" title="ToDo">ToDo</a>
            </li>
          </ul>
                       <h5>Modules</h5>
                  <ul>
                  <li class="none">
                          <a href="core/index.html" title="core">core</a>
            </li>
                  <li class="none">
                          <a href="demo/index.html" title="demo">demo</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                <li class="expanded">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                    <ul>
                      <li class="none">
            <strong>About</strong>
          </li>
                      <li class="none">
                          <a href="dependencies.html" title="Dependencies">Dependencies</a>
            </li>
                      <li class="none">
                          <a href="dependency-info.html" title="Dependency Information">Dependency Information</a>
            </li>
                      <li class="none">
                          <a href="dependency-management.html" title="Dependency Management">Dependency Management</a>
            </li>
                      <li class="none">
                          <a href="license.html" title="Project License">Project License</a>
            </li>
                      <li class="none">
                          <a href="modules.html" title="Project Modules">Project Modules</a>
            </li>
                      <li class="none">
                          <a href="plugin-management.html" title="Plugin Management">Plugin Management</a>
            </li>
                      <li class="none">
                          <a href="team-list.html" title="Project Team">Project Team</a>
            </li>
                      <li class="none">
                          <a href="source-repository.html" title="Source Repository">Source Repository</a>
            </li>
                      <li class="none">
                          <a href="project-summary.html" title="Project Summary">Project Summary</a>
            </li>
              </ul>
        </li>
                                                                                                                                            <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <h1>spBee - Stored Procedure Bee</h1>
<p>This framework allows to declare the stored procedures calls declarative instead of programmatically. Only the interfaces, the entities and few annotations need to be written. The code for the stored procedures, the necessary entity mappers and the implementations of the DAO interfaces are generated by spBee. It&#x2019;s also possible to use abstract classes instead of interfaces.</p>
<p>An important point is that there is no magic behind this framework like JPA/Hibernate with crazy reflection, proxies and framework logic. The only logic is how to translate the annotations to the corresponding Java code. Thereby spBee has only about 1700 LoC (measured with <a class="externalLink" href="https://www.npmjs.com/package/sloc">sloc</a>).</p>
<p>Everything is done at compile time. Therefore there is no performance shortcoming. No reflection. No proxies.</p>
<p>So some people will wonder why the hell should they use stored procedures? Then read <a href="why-stored-procedures.html">my thoughts about</a> that topic.</p>
<div class="section">
<h2><a name="Requirements"></a>Requirements</h2>

<ul>
  
<li>Java 8</li>
  
<li>Spring JDBC as dependency: which is used internally</li>
  
<li>Spring Context for the Dependency Injection
  
<ul>
    
<li>Component scan needs to be configured to autowire the implementation of the generated classes</li>
  </ul></li>
  
<li><tt>spBee#core</tt> as dependency</li>
  
<li><tt>at.rseiler.spbee.core.SPBeeAnnotationProcessor</tt> as annotation processor</li>
</ul>
<p>Spring is needed because spBee builds on top of <tt>org.springframework.jdbc.object.StoredProcedure</tt> and uses Spring`s Dependency Injection.</p>
<p><b>Important</b>: because spBee is not yet on the Maven Central Repository it&#x2019;s necessary to download the project and install it yourself. Because spBee has a dependency on the <a class="externalLink" href="https://github.com/rseiler/pom-project/">pom-project</a> you need first to download and install it. Or download the <a href="builds/spbee-core-1.0.jar">jar file directly</a>.</p></div>
<div class="section">
<h2><a name="How_it_works_short"></a>How it works (short)</h2>
<p>Within Java 1.6 it&#x2019;s possible to pre process annotations (before the code is compiled). In this pre process phase it&#x2019;s also possible to generate code (Java source files or Java class files). spBee uses this mechanism to generate the boilerplate code for the stored procedures, the entity mappers and the DAO implementations. spBee generates readable Java code because this allows to set break points in the generated code. Another useful effect is that you can just grab the generated files and work with them - you don&#x2019;t rely forever on spBee.</p></div>
<div class="section">
<h2><a name="How_to_configure_spBee"></a>How to configure spBee</h2>
<p>Look at <tt>spBee#demo</tt> to see the a runnable project with minimal configuration to use spBee.</p>
<div class="section">
<h3><a name="Maven"></a>Maven</h3>
<p>In Maven you need to add spBee as dependency and define spBee`s annotation processor. That&#x2019;s it.</p>

<div class="source">

<div class="source">
<pre class="prettyprint lang-xml">
&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
            &lt;version&gt;3.2&lt;/version&gt;
            &lt;configuration&gt;
                &lt;source&gt;1.8&lt;/source&gt;
                &lt;target&gt;1.8&lt;/target&gt;
                &lt;annotationProcessors&gt;
                    &lt;annotationProcessor&gt;
                        at.rseiler.spbee.core.SPBeeAnnotationProcessor
                    &lt;/annotationProcessor&gt;
                &lt;/annotationProcessors&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;at.rseiler.spbee&lt;/groupId&gt;
        &lt;artifactId&gt;core&lt;/artifactId&gt;
        &lt;version&gt;1.0&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
        &lt;version&gt;${spring.version}&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</pre></div>
</div></div>
<div class="section">
<h3><a name="Spring"></a>Spring</h3>
<p>In Spring you need to define the <tt>dataSource</tt> and the <tt>component-scan</tt>. The component scan must include the <tt>@Dao</tt> annotated interfaces and abstract classes.</p>

<div class="source">

<div class="source">
<pre class="prettyprint lang-xml">
&lt;context:component-scan base-package=&quot;your.package.name&quot;/&gt;

&lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;
    &lt;property name=&quot;driverClassName&quot; value=&quot;org.hsqldb.jdbc.JDBCDriver&quot;/&gt;
    &lt;property name=&quot;url&quot; value=&quot;jdbc:hsqldb:mem:mymemdb&quot;/&gt;
    &lt;property name=&quot;username&quot; value=&quot;sa&quot;/&gt;
    &lt;property name=&quot;password&quot; value=&quot;&quot;/&gt;
&lt;/bean&gt;
</pre></div>
</div></div></div>
<div class="section">
<h2><a name="Simple_Example"></a>Simple Example</h2>
<p>A simple example of the usage of spBee. The <tt>User</tt> class and the <tt>UserDao</tt> interface is all what is needed to call the both stored procedures below and get the <tt>User</tt> objects.</p>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">
@Entity
public class User {

    private int id;
    private String name;

    private User() {
    }

    @MappingConstructor
    public User(int id, String name) {
        this(id, name);
    }

     public int getId() {
        return id;
    }

    public String getName() {
        return name;
    }
}

@Dao
public interface UserDao {

    // list of entities
    @StoredProcedure(&quot;sp_get_users&quot;)
    List&lt;User&gt; getUsers();


    // single entity
    @StoredProcedure(&quot;sp_get_user&quot;)
    public User getUser(int id);

}

// execution
List&lt;User&gt; users = userDao.getUsers();
User user = userDao.getUser(1);
</pre></div>
</div>

<div class="source">

<div class="source">
<pre class="prettyprint lang-sql">

CREATE PROCEDURE sp_get_users()
  READS SQL DATA
  DYNAMIC RESULT SETS 1
  BEGIN ATOMIC

    DECLARE resultUser CURSOR WITH RETURN FOR
      SELECT
        id,
        name
      FROM User;

    OPEN resultUser;
  END;

CREATE PROCEDURE sp_get_user(idUser INT)
READS SQL DATA
DYNAMIC RESULT SETS 1
BEGIN ATOMIC

  DECLARE resultUser CURSOR WITH RETURN FOR
    SELECT
      id,
      name
    FROM User
    WHERE id = idUser;

  OPEN resultUser;
END;

</pre></div>
</div></div>
<div class="section">
<h2><a name="Return_Types"></a>Return Types</h2>
<p>The list of all possible return types of a stored procedure method.</p>
<div class="section">
<h3><a name="Void"></a>Void</h3>
<p>It the stored procedure doesn&#x2019;t return anything. If the stored procedure nevertheless returns something then it&#x2019;s ignored.</p></div>
<div class="section">
<h3><a name="List"></a>List</h3>
<p>If the stored procedure returns several rows then just use a generic list as return type. If no row is returned by the stored procedure then an empty list will be returned.</p></div>
<div class="section">
<h3><a name="Entity"></a>Entity</h3>
<p>The generated code will automatically retrieve the element from the list and return it.</p>

<ul>
  
<li>If no row is returned then a <tt>ObjectDoesNotExist</tt> runtime exception is thrown.
  
<ul>
    
<li>It&#x2019;s possible that in this case <tt>null</tt> is returned if the <tt>@ReturnNull</tt> annotation is used.</li>
    
<li>It&#x2019;s possible that in this case <tt>Optional.empty()</tt> is returned if the Entity is packed into an <tt>Optional</tt> type.</li>
  </ul></li>
  
<li>If more than one row is returned then a <tt>MultipleObjectsReturn</tt> runtime exception is thrown.</li>
</ul></div>
<div class="section">
<h3><a name="ResultSet"></a>ResultSet</h3>
<p>If the stored procedure returns several result sets then we need to model it in Java. <a href="#example-result-set">Example</a>.</p>

<ul>
  
<li>Write a class which contains for each result set a corresponding field. These fields can be annotated with: <tt>@ReturnNull</tt> and <tt>@RowMapper</tt></li>
  
<li>Create an corresponding constructor to initialize the fields.</li>
  
<li>Annotate the written class with <tt>@ResultSet</tt>.</li>
</ul></div></div>
<div class="section">
<h2><a name="Important_Notes"></a>Important Notes</h2>
<p>Please note that the order of the Java fields and parameters is important and must match the corresponding stored procedure.</p>
<div class="section">
<h3><a name="aStoredProcedure"></a>@StoredProcedure</h3>
<p>The order of the parameters must be the same as the input parameters of the stored procedure.</p>
<p>As input parameters only basic types are allowed. See <a href="core/xref/at/rseiler/spbee/core/generator/StoredProcedureGenerator.html">StoredProcedureGenerator</a>#getSqlParameter. If you use arrays then they must use the class kind not the primitive kind. E.g. use <tt>Integer[]</tt> instead of <tt>int[]</tt>. See <a href="core/xref/at/rseiler/spbee/core/generator/StoredProcedureGenerator.html">StoredProcedureGenerator</a>#getArrayType.</p></div>
<div class="section">
<h3><a name="aEntity"></a>@Entity</h3>
<p>The order of the parameters of the constructor must be the same as the columns of the stored procedure.</p>
<p>As constructor variables only basic types are allowed. See <a href="/core/xref/at/rseiler/spbee/core/generator/MapperGenerator.html">MapperGenerator</a>#getResultSetMethod.</p></div>
<div class="section">
<h3><a name="aResultSet"></a>@ResultSet</h3>
<p>The order of the class fields <b>and</b> the parameters of the constructor must be the same as the returned result sets.</p></div>
<div class="section">
<h3><a name="aDao_Abstract_Class"></a><tt>@Dao</tt> Abstract Class</h3>

<ul>
  
<li>the idea behind the abstract class is that it&#x2019;s possible to mix spBee methods with own methods
  
<ul>
    
<li>if some special calls to the database are needed which spBee doesn&#x2019;t support</li>
    
<li>if you don&#x2019;t want to return the result of the stored procedure directly. E.g.: in <tt>spBee#demo</tt> look at <tt>AbstractUserDao#getUserWithPermissions</tt>.</li>
  </ul></li>
  
<li>two kinds of constructors are supported
  
<ul>
    
<li>default constructor (no parameters)</li>
    
<li>constructor with <tt>javax.sql.DataSource</tt> as parameter</li>
  </ul></li>
</ul></div></div>
<div class="section">
<h2><a name="Interceptor"></a>Interceptor</h2>
<p>The idea of the interceptor is to log and monitor the stored procedure calls. If a interceptor is configured then before and after the stored procedure call the interceptor is called. It&#x2019;s not possible to modify the arguments of the stored procedure call. The only thing what would be possible is to throw a RuntimeException to cancel the stored procedure call.</p>
<p>The interceptor class must contain following method signatures:</p>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">
/**
 * This method will be called before the stored procedure call.
 *
 * @param spName    the name of the stored procedure
 * @param arguments the arguments of the stored procedure
 * @return the ID object to identify the call in the after method
 **/
public static Object before(String spName, Object... arguments)

/**
 * This method will be called after the invocation of the stored procedure.
 *
 * @param id        the ID object (returned from the before method)
 * @param spName    the name of the stored procedure
 * @param arguments the arguments of the stored procedure
 */
public static void after(Object id, String spName, Object... arguments)
</pre></div>
</div>
<p>Then the <tt>spbee.properties</tt> file is required to be in the class path with the interceptor class configured:</p>

<div class="source">
<div class="source">
<pre>interceptor=at.rseiler.spbee.demo.SpLogger
</pre></div></div>
<p>In the <tt>spbee#demo</tt> module is an example of a stored procedure logger. See <tt>at.rseiler.spbee.demo.SpLogger</tt>.</p></div>
<div class="section">
<h2><a name="Generated_Classes"></a>Generated Classes</h2>
<p>All non spBee related annotations will be added to the methods of the DAO implementation class.</p>
<p>Thereby it&#x2019;s possible to use the <tt>@Transactional</tt> annotation on the interface or the abstract class.</p>

<table border="0" class="bodyTable">
    <thead>
    
<tr class="a">
        
<th>Type</th>
        
<th>Pattern</th>
        
<th>Description</th>
    </tr>
    </thead>
    <tbody>
    
<tr class="b">
        
<td>DAO</td>
        
<td>*.{CLASS_NAME}Impl</td>
        
<td>
            The class name will be the name of the annotated class with <tt>Impl</tt> as postfix.<br />
        </td>
    </tr>
    
<tr class="a">
        
<td>Stored Procedure</td>
        
<td>*.storedprocedure.{STORED_PROCEDURE_NAME}</td>
        
<td>
            The class name will be the name of the stored procedure (defined in the <tt>@StoredProcedure</tt> annotation).
            But the name will be modified a little bit:<br />
            The first character will be uppercase, underscores will be removed and the following character will be uppercase.<br />
            The package is relative to the DAO.
        </td>
    </tr>
    
<tr class="b">
        
<td>Mapper</td>
        
<td>*.mapper.{ENTITY_NAME}{CONSTRUCTOR_NAME}Mapper</td>
        
<td>
            The constructor name is <tt>Default</tt> if no other name is defined (with <tt>@MappingConstructor(&quot;some_constructor_name&quot;)</tt><br />
            The package is relative to the entity.
        </td>
    </tr>
    </tbody>
</table></div>
<div class="section">
<h2><a name="Annotations"></a>Annotations</h2>

<table border="0" class="bodyTable">
    <thead>
    
<tr class="a">
        
<th>Name</th>
        
<th>Target</th>
        
<th>Description</th>
    </tr>
    </thead>
    
<tr class="b">
        
<td>@Dao</td>
        
<td>TYPE</td>
        
<td>Annotate the DAO with this annotation. Then spBee will generate the DAO implementation class.</td>
    </tr>
    
<tr class="a">
        
<td>@Entity</td>
        
<td>TYPE</td>
        
<td>Annotate all entities which are used as return types in the stored procedure methods of the DAO.</td>
    </tr>
    
<tr class="b">
        
<td>@MappingConstructor</td>
        
<td>CONSTRUCTOR|METHOD|FIELD</td>
        
<td>
            Annotate the constructors and give them names. These constructors will be used to create an entity
            instance. The names allow to use different views/subsets of an entity.
            <a href="#example-mapping-constructor">Example.</a>
        </td>
    </tr>
    
<tr class="a">
        
<td>@ResultSet</td>
        
<td>TYPE</td>
        
<td>
            If an stored procedure returns several result sets then a Java class will represent these result sets. These
            class must be annotated with <tt>@ResultSet</tt>. The fields of the class describes the different result sets
            and the fields can be annotated with: <tt>@ReturnNull</tt> or <tt>@RowMapper</tt>.
            <a href="#example-result-set">Example.</a>
        </td>
    </tr>
    
<tr class="b">
        
<td>@ReturnNull</td>
        
<td>METHOD|FIELD</td>
        
<td>
            If the stored procedure method just returns an entity (not a list of entities) and if no row is returned
            then the method will return <tt>null</tt>. <a href="#example-return-null">Example.</a>
        </td>
    </tr>
    
<tr class="a">
        
<td>@RowMapper</td>
        
<td>METHOD|FIELD</td>
        
<td>
            The value defines the class of the mapper which should be used to map the entities. Instead of the generated
            default mappers.
            <a href="#example-row-mapper">Example.</a>
        </td>
    </tr>
    
<tr class="b">
        
<td>@StoredProcedure</td>
        
<td>METHOD</td>
        
<td>
            The value defines the name of the stored procedure. Only methods annotated with @StoredProcedure will be
            processed by spBee.
        </td>
    </tr>
</table></div>
<div class="section">
<h2><a name="More_Examples"></a>More Examples</h2>
<p>More examples can be found in the <tt>spBee#demo</tt> module.</p>
<div class="section">
<h3><a name="Multiple_ResultSets_from_the_stored_procedure"></a>Multiple <tt>@ResultSet</tt>s from the stored procedure <a name="example-result-set"></a></h3>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">

@ResultSet
public class UserPermissionsResultSet {

    @RowMapper(SimpleUserMapper.class)
    private final Optional&lt;User&gt; user;
    private final List&lt;Permission&gt; permissions;

    public UserPermissionsResultSet(Optional&lt;User&gt; user, List&lt;Permission&gt; permissions) {
        this.user = user;
        this.permissions = permissions;
    }

    public Optional&lt;User&gt; getUser() {
        if (user.isPresent()) {
            return Optional.of(new Builder(user.get()).permissions(permissions).build());
        }
        return Optional.empty();
    }

}


@Dao
public abstract class AbstractUserDao {

    @StoredProcedure(&quot;sp_get_user_with_permissions&quot;)
    public abstract UserPermissionsResultSet getUserWithPermissions(int id);

}

</pre></div>
</div></div>
<div class="section">
<h3><a name="Use_your_own_RowMapper"></a>Use your own <tt>@RowMapper</tt> <a name="example-row-mapper"></a></h3>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">

public class SimpleUserMapper implements RowMapper&lt;User&gt; {

    public User mapRow(ResultSet rs, int rowNum) throws SQLException {
        return new User(
                rs.getInt(1),
                &quot;not loaded&quot;,
                new ArrayList&lt;&gt;());
    }

}

</pre></div>
</div>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">

@Dao
public interface UserDao {

    @RowMapper(SimpleUserMapper.class)
    @StoredProcedure(&quot;sp_get_simple_users&quot;)
    List&lt;User&gt; getSimpleUsersWithOwnMapper();

}

</pre></div>
</div>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">

@ResultSet
public class UserPermissionsResultSet {

    @RowMapper(SimpleUserMapper.class)
    private final User user;
    private final List&lt;Permission&gt; permissions;

    public UserPermissionsResultSet(User user, List&lt;Permission&gt; permissions) {
        this.user = user;
        this.permissions = permissions;
    }
}

</pre></div>
</div></div>
<div class="section">
<h3><a name="Return_null_instead_of_an_ObjectDoesNotExist_runtime_exception"></a>Return <tt>null</tt> instead of an <tt>ObjectDoesNotExist</tt> runtime exception <a name="example-return-null"></a></h3>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">

@Dao
public interface UserDao {

    @ReturnNull
    @StoredProcedure(&quot;sp_get_simple_user&quot;)
    User getUser();

}

@ResultSet
public class UserPermissionsResultSet {

    @ReturnNull
    private final User user;
    private final List&lt;Permission&gt; permissions;

    public UserPermissionsResultSet(Optional&lt;User&gt; user, List&lt;Permission&gt; permissions) {
        this.user = user;
        this.permissions = permissions;
    }
}

</pre></div>
</div></div>
<div class="section">
<h3><a name="Return_Optional.empty_instead_of_an_ObjectDoesNotExist_runtime_exception"></a>Return <tt>Optional.empty()</tt> instead of an <tt>ObjectDoesNotExist</tt> runtime exception <a name="example-return-null"></a></h3>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">

@Dao
public interface UserDao {

    @StoredProcedure(&quot;sp_get_simple_user&quot;)
    Optional&lt;User&gt; getUser();

}

@ResultSet
public class UserPermissionsResultSet {

    private final Optional&lt;User&gt; user;
    private final List&lt;Permission&gt; permissions;

    public UserPermissionsResultSet(Optional&lt;User&gt; user, List&lt;Permission&gt; permissions) {
        this.user = user;
        this.permissions = permissions;
    }
}

</pre></div>
</div></div>
<div class="section">
<h3><a name="aMappingConstructor"></a><tt>@MappingConstructor</tt> <a name="example-mapping-constructor"></a></h3>

<div class="source">

<div class="source">
<pre class="prettyprint lang-java">

@Entity
public class User {

    private final long loginId;
    private final String userName;
    private final int age;

    @MappingConstructor
    public User(long loginId, String userName, int age) {
        this.loginId = loginId;
        this.userName = userName;
        this.age = age;
    }

    @MappingConstructor(&quot;userCoreData&quot;)
    public User(long loginId, String userName) {
        this.loginId = loginId;
        this.userName = userName;
        this.age = -1;
    }

}

@Dao
public abstract class AbstractUserDao {

    @StoredProcedure(&quot;pr_get_user&quot;)
    public abstract User getUser(long loginId);

    @MappingConstructor(&quot;userCoreData&quot;)
    @StoredProcedure(&quot;pr_get_user_core_data&quot;)
    public abstract User getUserCoreData(long loginId);

}

</pre></div>
</div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                   2015.
          All rights reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>